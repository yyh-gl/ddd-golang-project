variables:
  work_dir: ~/workspaces/Go/src/github.com/yyh-gl/hobigon-golang-api-server
  git:
    commit: $(git rev-parse HEAD)
    branch: $(git rev-parse --abbrev-ref HEAD)

build:
  summary: ビルド
  command: GO111MODULE=on GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -ldflags "-X main.COMMIT={{.git.commit}} -X main.BRANCH={{.git.branch}}" -o ./docker/api/bin/api-server ./cmd/api/main.go

lint:
  summary: Docker経由でLint実行
  command: docker-compose exec -T api golangci-lint run --tests --disable-all --enable=goimports --enable=golint --enable=govet --enable=errcheck ./...
